<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flight summaries • Kulan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Flight summaries">
<meta property="og:description" content="Kulan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Kulan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Flight_summaries.html">Flight summaries</a>
    </li>
    <li>
      <a href="../articles/Getting_raster_values_form_a_Digital_Elevation_Model.html">Getting raster values form a Digital Elevation Model</a>
    </li>
    <li>
      <a href="../articles/working-with-the-kulan-package.html">Working with the Kulan package</a>
    </li>
    <li>
      <a href="../articles/Working_out_the_trapezoid.html">Working out the trapezoid</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Flight_summaries_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Flight_summaries_files/kePrint-0.0.1/kePrint.js"></script><link href="Flight_summaries_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Flight summaries</h1>
            
      
      
      <div class="hidden name"><code>Flight_summaries.Rmd</code></div>

    </div>

    
    
<div id="call-in-files-from-a-nested-folder-and-clean-them" class="section level2">
<h2 class="hasAnchor">
<a href="#call-in-files-from-a-nested-folder-and-clean-them" class="anchor"></a>Call in files from a nested folder and clean them</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span>
<span class="co">#here::here()</span>
<span class="va">path</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/"</span>, <span class="st">"data/tables"</span><span class="op">)</span>
<span class="co">#list.files(path)</span>
<span class="va">all_dfs</span><span class="op">=</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_tables.html">get_tables</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">".csv"</span><span class="op">)</span>
<span class="va">all_dfs</span><span class="op">=</span><span class="va">all_dfs</span> <span class="op">%&gt;%</span> 
  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span><span class="va">.</span>, Flight <span class="op">=</span> <span class="va">class</span><span class="op">)</span>

<span class="co">#clean up the time format if needed (some issues with xls files)</span>
<span class="co"># all_dfs &lt;- all_dfs %&gt;%</span>
<span class="co">#             mutate(time = update(time,</span>
<span class="co">#                        year = year(date),</span>
<span class="co">#                        month = month(date),</span>
<span class="co">#                        day = day(date)),</span>
<span class="co">#             hms = hms::as_hms(time))</span>

<span class="co">#Make sure values are recognized as numeric</span>
<span class="va">all_dfs</span><span class="op">=</span><span class="va">all_dfs</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>banking_angle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">banking_angle</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>tangage<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">tangage</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>azimuth<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">azimuth</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>gps_course<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">gps_course</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>speed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>gps_speed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">gps_speed</span><span class="op">)</span><span class="op">)</span>

<span class="co">#shows if values are correctly defined</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">all_dfs</span><span class="op">)</span></code></pre></div>
<pre><code>## Classes 'data.table' and 'data.frame':   12670 obs. of  19 variables:
##  $ photo_no               : chr  "DSC06212.JPG" "DSC06213.JPG" "DSC06214.JPG" "DSC06215.JPG" ...
##  $ date                   : chr  "16.07.2020" "16.07.2020" "16.07.2020" "16.07.2020" ...
##  $ time                   : chr  "02:34:47" "02:34:50" "02:34:54" "02:37:42" ...
##  $ lat_dec                : num  45.8 45.8 45.8 45.8 45.8 ...
##  $ lon_dec                : num  61.2 61.2 61.2 61.2 61.2 ...
##  $ alt_above_the_sea_level: num  53.7 53.8 53.9 86.7 141.4 ...
##  $ alt_above_launch_point : num  0.4 0.5 0.2 37.9 91.5 ...
##  $ alt_above_ground       : num  0 0 0 33 87.7 ...
##  $ banking_angle          : num  -0.7 -1.6 0.1 -4.7 22.4 21.1 25.7 13.7 17.9 22.6 ...
##  $ tangage                : num  4 2.8 1.3 9.2 3.3 4 7 9.8 5.2 4.9 ...
##  $ azimuth                : num  75 75 76 74 85 162 227 297 10 88 ...
##  $ gps_course             : num  76.2 75.6 75.7 76.9 74.6 ...
##  $ speed                  : num  0 0 0 82.8 86 ...
##  $ gps_speed              : num  0 0 0 66.6 62.3 ...
##  $ camera_position        : chr  "right" "right" "right" "right" ...
##  $ species                : logi  NA NA NA NA NA NA ...
##  $ number                 : logi  NA NA NA NA NA NA ...
##  $ Flight                 : chr  "Flight1" "Flight1" "Flight1" "Flight1" ...
##  $ v18                    : logi  NA NA NA NA NA NA ...
##  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</code></pre>
</div>
<div id="extract-raster-values-from-a-dem-for-the-altitude-above-ground-calculations" class="section level2">
<h2 class="hasAnchor">
<a href="#extract-raster-values-from-a-dem-for-the-altitude-above-ground-calculations" class="anchor"></a>Extract raster values from a DEM for the altitude above ground calculations</h2>
<p>At this point you could add the altitude from the DEM [see the “Getting raster values form a Digital Elevation Model” vignette]. Here, for this example, we will use the column called Altitude above the ground (<em>because we can not include all the DEMs we would need inside the package</em>).</p>
</div>
<div id="remove-points-where-the-drone-is-in-take-off-or-landing" class="section level2">
<h2 class="hasAnchor">
<a href="#remove-points-where-the-drone-is-in-take-off-or-landing" class="anchor"></a>Remove points where the drone is in take-off or landing</h2>
<div id="first-plot-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#first-plot-the-data" class="anchor"></a>First plot the data</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_dfs</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>time2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time2</span>, <span class="va">alt_above_ground</span>, colour<span class="op">=</span><span class="va">Flight</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"time"</span>,y<span class="op">=</span> <span class="st">"Altitude above ground"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Flight</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 25 rows containing missing values (geom_point).</code></pre>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>From the distribution of the altitudes we can see that anything below 200 m is probably take-off or landing phase.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_dfs</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">alt_above_ground</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"Red"</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 25 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>However, we might want to look more closely at Flight5 as it seems some of the points during the flight are below 200m.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_dfs</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight5"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">alt_above_ground</span>, colour<span class="op">=</span><span class="va">Flight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span> <span class="st">"Altitude above sea level"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">200</span>, colour<span class="op">=</span><span class="st">"Red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">190</span>, colour<span class="op">=</span><span class="st">"Green"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>So a couple of points in Flight5 during the actual flight were below our threshold of 200m. So let’s be conservative and go for 190m instead. You can change this threshold by changing the value in the code below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">=</span><span class="va">all_dfs</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">alt_above_ground</span><span class="op">&gt;</span><span class="fl">190</span><span class="op">)</span><span class="co"># The threshold is controlled here - change it by changing the number from 190</span></code></pre></div>
<p>Now all the points in consideration are above 190m.</p>
</div>
</div>
<div id="drone-flight-descriptors" class="section level2">
<h2 class="hasAnchor">
<a href="#drone-flight-descriptors" class="anchor"></a>Drone flight descriptors</h2>
<div id="altitude-above-ground-summary" class="section level3">
<h3 class="hasAnchor">
<a href="#altitude-above-ground-summary" class="anchor"></a>Altitude above ground summary</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
   <span class="fu">mutate</span><span class="op">(</span>time2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time2</span>,<span class="va">alt_above_ground</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"time"</span>, y<span class="op">=</span><span class="st">"Altitude above the ground"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">Flight</span><span class="op">~</span><span class="va">.</span>, scale<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div id="trapeze---drone-footprint-for-specific-altitude-example" class="section level2">
<h2 class="hasAnchor">
<a href="#trapeze---drone-footprint-for-specific-altitude-example" class="anchor"></a>Trapeze - drone footprint for specific altitude example</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#####################################################################################################################</span>
<span class="co"># Drone &amp; camera setup:</span>
<span class="co"># Camera: SONY DCS-RX1RM2</span>
<span class="co"># Sensor: 35.9 x 24.0 mm</span>
<span class="co"># VIEWING ANGLE LENS (CORRESPONDING 35 MM FORMAT) 63 degrees (35mm))</span>
<span class="co"># Image width in pixel: 7952</span>
<span class="co"># Image height in pixel: 5304</span>
<span class="co"># Camera angles 25.7 and 25.0 degrees</span>
<span class="co"># distance between two lenses is 2,9-3,0 cm - this distance is in the forward direction </span>
<span class="co"># as both cameras are directly in the middle of the drone</span>
<span class="co">#####################################################################################################################</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: package 'patchwork' was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#short version of the below functions:</span>
<span class="co">#Kulan::plot_trapezoid(altitude = 200, banking_angle = 0)</span>

<span class="co"># calculat trapez based on drone specifications</span>
<span class="co"># sensor and camera details</span>
<span class="va">xsensor</span> <span class="op">=</span> <span class="fl">35.9</span>   <span class="co">#sensor width</span>
<span class="va">ysensor</span> <span class="op">=</span> <span class="fl">24</span>     <span class="co">#sensor height</span>
<span class="va">focallen</span>    <span class="op">=</span> <span class="fl">35</span>     <span class="co">#focal length of lens</span>
<span class="va">ygim</span>        <span class="op">=</span> <span class="fl">0</span>      <span class="co">#roll</span>
<span class="va">xgim1</span>    <span class="op">=</span> <span class="fl">25</span>     <span class="co">#banking angle = camera angle 1</span>
<span class="va">Xgim2</span>   <span class="op">=</span> <span class="fl">25.7</span>   <span class="co">#banking angle = camera angle 2</span>
<span class="va">alt</span>         <span class="op">=</span> <span class="fl">245</span>    <span class="co">#fight height - change according to values seen under 4.3., I subsequently changed alt = alt, so it </span>
<span class="va">imW</span>      <span class="op">=</span> <span class="fl">7952</span>   <span class="co">#sensor width</span>
<span class="va">imH</span> <span class="op">=</span> <span class="fl">5304</span>   <span class="co">#sensor length</span>
<span class="co">#####################################################################################################################</span>
<span class="co">#######################  5.2.1. trapeze side view</span>
<span class="co">#####################################################################################################################</span>
<span class="va">deg2rad</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">rad</span> <span class="op">=</span> <span class="va">d</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">180</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rad</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">rad2deg</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">rad</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">deg</span><span class="op">=</span><span class="va">rad</span><span class="op">*</span><span class="fl">180</span><span class="op">/</span><span class="va">pi</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">FOV.wide</span><span class="op">&lt;-</span><span class="fu">rad2deg</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">xsensor</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">focallen</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">FOV.high</span><span class="op">&lt;-</span><span class="fu">rad2deg</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">atan</a></span><span class="op">(</span><span class="va">ysensor</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">focallen</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu">deg2rad</span><span class="op">(</span><span class="va">xgim1</span><span class="op">)</span>
<span class="co"># horizontal field of view</span>
<span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu">deg2rad</span><span class="op">(</span><span class="va">FOV.wide</span><span class="op">)</span>
<span class="co"># vertical field of view</span>
<span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu">deg2rad</span><span class="op">(</span><span class="va">FOV.high</span><span class="op">)</span>

<span class="va">Dc</span> <span class="op">=</span> <span class="va">alt</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta</span><span class="op">-</span><span class="va">phi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Df</span> <span class="op">=</span> <span class="va">alt</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta</span><span class="op">+</span><span class="va">phi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Dm</span> <span class="op">=</span> <span class="va">alt</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta</span><span class="op">+</span><span class="va">phi</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>

<span class="va">Rc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">alt</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Rm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">alt</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Rf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">alt</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

<span class="va">dt.triangle</span>  <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, polygon.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Dc</span>,<span class="fl">0</span><span class="op">)</span>, polygon.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alt</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt.triangle2</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, polygon.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Df</span>,<span class="fl">0</span><span class="op">)</span>, polygon.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alt</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="co">#plotting side view</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">geom_polygon</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dt.triangle</span>
  ,<span class="fu">aes</span><span class="op">(</span>
    x<span class="op">=</span><span class="va">polygon.x</span>
    ,y<span class="op">=</span><span class="va">polygon.y</span>
    ,group<span class="op">=</span><span class="va">group</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span><span class="op">+</span><span class="fu">geom_polygon</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dt.triangle2</span>
  ,<span class="fu">aes</span><span class="op">(</span>
    x<span class="op">=</span><span class="va">polygon.x</span>
    ,y<span class="op">=</span><span class="va">polygon.y</span>
    ,group<span class="op">=</span><span class="va">group</span>
    , alpha<span class="op">=</span><span class="fl">0.2</span>
  <span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Horizontal distance"</span>, y<span class="op">=</span><span class="st">"Vertical distance"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div id="adding-the-other-camera" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-the-other-camera" class="anchor"></a>Adding the other camera</h3>
<p>In our case we have two cameras with different angles and we can plot these to show the images horizontal footprints.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">deg2rad</span><span class="op">(</span><span class="va">Xgim2</span><span class="op">)</span>
<span class="va">Dc2</span> <span class="op">=</span> <span class="va">alt</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Df2</span> <span class="op">=</span> <span class="va">alt</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Dm2</span> <span class="op">=</span> <span class="va">alt</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>

<span class="va">dt.triangle</span>  <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, polygon.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Dc</span>,<span class="fl">0</span><span class="op">)</span>, polygon.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alt</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt.triangle2</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, polygon.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Df</span>,<span class="fl">0</span><span class="op">)</span>, polygon.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alt</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="va">dt.triangle3</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, polygon.x3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="va">Dc2</span>,<span class="fl">0</span><span class="op">)</span>, polygon.y3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alt</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">dt.triangle3</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, polygon.x3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="va">Df2</span>,<span class="fl">0</span><span class="op">)</span>, polygon.y3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alt</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">geom_polygon</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dt.triangle</span>
  ,<span class="fu">aes</span><span class="op">(</span>
    x<span class="op">=</span><span class="va">polygon.x</span>
    ,y<span class="op">=</span><span class="va">polygon.y</span>
    ,group<span class="op">=</span><span class="va">group</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span><span class="op">&lt;-</span><span class="va">p</span><span class="op">+</span><span class="fu">geom_polygon</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dt.triangle2</span>
  ,<span class="fu">aes</span><span class="op">(</span>
    x<span class="op">=</span><span class="va">polygon.x</span>
    ,y<span class="op">=</span><span class="va">polygon.y</span>
    ,group<span class="op">=</span><span class="va">group</span>
    , alpha<span class="op">=</span><span class="fl">0.2</span>
  <span class="op">)</span><span class="op">)</span>
<span class="va">p</span><span class="op">+</span><span class="fu">geom_polygon</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dt.triangle3</span>
  ,<span class="fu">aes</span><span class="op">(</span>
    x<span class="op">=</span><span class="va">polygon.x3</span>
    ,y<span class="op">=</span><span class="va">polygon.y3</span>
    ,group<span class="op">=</span><span class="va">group</span>
    , alpha<span class="op">=</span><span class="fl">0.2</span>
  <span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Horizontal distance"</span>, y<span class="op">=</span><span class="st">"Vertical distance"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div id="trapeze-top-view" class="section level2">
<h2 class="hasAnchor">
<a href="#trapeze-top-view" class="anchor"></a>Trapeze top view</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Top view</span>
<span class="va">Wc</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">alt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Wm</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc</span><span class="op">+</span><span class="va">Df</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">alt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="va">Wf</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">alt</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>

<span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df</span><span class="op">-</span><span class="va">Dc</span>, <span class="va">Df</span><span class="op">-</span><span class="va">Dc</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">positions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_polygon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="strip-width-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#strip-width-summary" class="anchor"></a>Strip-width summary</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">dfs_reduced</span><span class="op">=</span><span class="va">dfs_reduced</span><span class="op">%&gt;%</span> 
    <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">photo_no</span>, <span class="st">"IMG"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># remove empty photos</span>
  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span><span class="st">"strip_width"</span><span class="op">=</span><span class="fu"><a href="../reference/get_strip_width.html">get_strip_width</a></span><span class="op">(</span>alt<span class="op">=</span><span class="va">alt_above_ground</span>,banking_angle <span class="op">=</span> <span class="va">banking_angle</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="va">strip_width</span><span class="op">)</span>
 <span class="va">our_summary1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"strip width (m)"</span> <span class="op">=</span>
         <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"min"</span>       <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">strip_width</span><span class="op">)</span><span class="op">)</span>,
              <span class="st">"max"</span>       <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">strip_width</span><span class="op">)</span><span class="op">)</span>,
              <span class="st">"mean (sd)"</span> <span class="op">=</span> <span class="op">~</span><span class="fu">qwraps2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qwraps2/man/mean_sd.html">mean_sd</a></span><span class="op">(</span><span class="va">strip_width</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>


<span class="va">tab_1</span><span class="op">&lt;-</span><span class="fu">qwraps2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qwraps2/man/summary_table.html">summary_table</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dfs_reduced</span>, <span class="va">Flight</span><span class="op">)</span>,<span class="va">our_summary1</span><span class="op">)</span>
<span class="va">tab_1</span></code></pre></div>
<table class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Flight1 (N = 1665)</th>
<th align="left">Flight2 (N = 1491)</th>
<th align="left">Flight3 (N = 1407)</th>
<th align="left">Flight4 (N = 1638)</th>
<th align="left">Flight5 (N = 1498)</th>
<th align="left">Flight6 (N = 1820)</th>
<th align="left">Flight7 (N = 1443)</th>
<th align="left">Flight8 (N = 1533)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>strip width (m)</strong></td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
<td align="left">  </td>
</tr>
<tr class="even">
<td align="left">   min</td>
<td align="left">221</td>
<td align="left">228</td>
<td align="left">221</td>
<td align="left">229</td>
<td align="left">224</td>
<td align="left">214</td>
<td align="left">234</td>
<td align="left">213</td>
</tr>
<tr class="odd">
<td align="left">   max</td>
<td align="left">1069</td>
<td align="left">1725</td>
<td align="left">954</td>
<td align="left">921</td>
<td align="left">1205</td>
<td align="left">965</td>
<td align="left">1032</td>
<td align="left">1194</td>
</tr>
<tr class="even">
<td align="left">   mean (sd)</td>
<td align="left">307.22 ± 41.72</td>
<td align="left">316.14 ± 71.79</td>
<td align="left">297.64 ± 49.41</td>
<td align="left">300.94 ± 35.61</td>
<td align="left">309.27 ± 63.06</td>
<td align="left">290.50 ± 41.13</td>
<td align="left">310.60 ± 55.21</td>
<td align="left">296.27 ± 61.92</td>
</tr>
</tbody>
</table>
</div>
<div id="speed-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#speed-summary" class="anchor"></a>Speed summary</h2>
<p>Using the gps_speed we can plot the speed of the drone during each flight.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>rowid<span class="op">=</span><span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>time2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co">#ggplot(aes(time2,gps_speed))+# replace the next line with this to remove the alt_above_ground colour</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time2</span>,<span class="va">gps_speed</span>,colour<span class="op">=</span><span class="va">alt_above_ground</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"time"</span>, y<span class="op">=</span><span class="st">"gps speed"</span><span class="op">)</span><span class="op">+</span>
  <span class="co">#geom_point(colour="darkblue")+# add these lines too and remove the two above</span>
  <span class="co">#geom_line(colour="darkblue")+#</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Flight</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="distance-between-points-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#distance-between-points-summary" class="anchor"></a>Distance between points summary</h2>
<p>There are some very large distances moved at the start or the end of a Flight and these need to be filtered out to allow us to plot the distance more clearly. Anything above 250m is therefore removed in the plotting code below.The points are coloured by the gps_speed.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distance_df</span><span class="op">=</span><span class="va">dfs_reduced</span><span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>new_lat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">lat_dec</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>new_lon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">lon_dec</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>coord_dif<span class="op">=</span><span class="fu">distm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lon_dec</span>, <span class="va">lat_dec</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">new_lon</span>, <span class="va">new_lat</span><span class="op">)</span>, fun <span class="op">=</span> <span class="va">distHaversine</span><span class="op">)</span><span class="op">)</span>

<span class="va">distance_df</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
   <span class="fu">mutate</span><span class="op">(</span>time2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">coord_dif</span><span class="op">&lt;</span><span class="fl">250</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time2</span>,<span class="va">coord_dif</span>,colour<span class="op">=</span><span class="va">coord_dif</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_colour_gradientn</span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"time"</span>,y<span class="op">=</span><span class="st">"distance (m) between points"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Flight</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="banking-angle" class="section level2">
<h2 class="hasAnchor">
<a href="#banking-angle" class="anchor"></a>Banking Angle</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>rowid<span class="op">=</span><span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>time2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time2</span>,<span class="va">banking_angle</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"time"</span>, y<span class="op">=</span><span class="st">"Banking angle"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Flight</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="photograph-area-on-the-right-side" class="section level2">
<h2 class="hasAnchor">
<a href="#photograph-area-on-the-right-side" class="anchor"></a>Photograph area on the right side</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">=</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span><span class="st">"photo_area_R"</span><span class="op">=</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_photo_area.html">get_photo_area</a></span><span class="op">(</span>altitude <span class="op">=</span> <span class="va">alt_above_ground</span>,banking_angle <span class="op">=</span> <span class="va">banking_angle</span><span class="op">)</span><span class="op">)</span>


<span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">photo_area_R</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">photo_area_R</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"photograph area m2"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="photograph-area-on-the-left-side" class="section level2">
<h2 class="hasAnchor">
<a href="#photograph-area-on-the-left-side" class="anchor"></a>Photograph area on the left side</h2>
<p>We need to change the camera angle from the default (which is set for the right side camera) in order to calculate the photo area on the left.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">=</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span><span class="st">"photo_area_L"</span><span class="op">=</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_photo_area.html">get_photo_area</a></span><span class="op">(</span>altitude <span class="op">=</span> <span class="va">alt_above_ground</span>, angle_of_camera <span class="op">=</span> <span class="fl">25.7</span> ,banking_angle <span class="op">=</span> <span class="va">banking_angle</span><span class="op">)</span><span class="op">)</span>


<span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">photo_area_L</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">photo_area_L</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"photograph area m2"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="overlap" class="section level2">
<h2 class="hasAnchor">
<a href="#overlap" class="anchor"></a>Overlap</h2>
<p>The forward overlap is the percentage overlap that two consecutive images have. To calculate this value we could not use a single function so have developed a script to follow the process. This is hidden here in the rendered Markdown but contained in the script.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">overlap_df</span><span class="op">=</span><span class="va">distance_df</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">photo_no</span>, <span class="va">alt_above_ground</span>, <span class="va">coord_dif</span>, <span class="va">banking_angle</span>, <span class="va">Flight</span><span class="op">)</span>

<span class="va">overlap_df</span><span class="op">$</span><span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df</span><span class="op">$</span><span class="va">alt_above_ground</span>
<span class="va">overlap_df</span><span class="op">$</span><span class="va">altitude2</span><span class="op">=</span><span class="fu">lead</span><span class="op">(</span><span class="va">overlap_df</span><span class="op">$</span><span class="va">altitude1</span><span class="op">)</span>
<span class="va">overlap_df</span><span class="op">$</span><span class="va">distance</span><span class="op">=</span><span class="va">overlap_df</span><span class="op">$</span><span class="va">coord_dif</span>
<span class="va">overlap_df</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df</span><span class="op">$</span><span class="va">banking_angle</span>
<span class="va">overlap_df</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">=</span><span class="fu">lead</span><span class="op">(</span><span class="va">overlap_df</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">)</span>


<span class="va">overlap_df1</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight1"</span><span class="op">)</span>

<span class="va">overlap_df1</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df1</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df1</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df1</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df1</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df1</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df1</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
  <span class="va">overlap_df1</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<pre><code>## Warning: package 'sp' was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">overlap_df1</span><span class="op">$</span><span class="va">forward_overlap</span>

<span class="co">###############################################################</span>

<span class="va">overlap_df2</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight2"</span><span class="op">)</span>

<span class="va">overlap_df2</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df2</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df2</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df2</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df2</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df2</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df2</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df2</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df2</span><span class="op">$</span><span class="va">forward_overlap</span>

<span class="co">########################################################</span>
<span class="va">overlap_df3</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight3"</span><span class="op">)</span>

<span class="va">overlap_df3</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df3</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df3</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df3</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df3</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df3</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df3</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df3</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df3</span><span class="op">$</span><span class="va">forward_overlap</span>

<span class="co">###########################################################</span>

<span class="va">overlap_df4</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight4"</span><span class="op">)</span>

<span class="va">overlap_df4</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df4</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df4</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df4</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df4</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df4</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df4</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df4</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df4</span><span class="op">$</span><span class="va">forward_overlap</span>

<span class="co">###############################################################</span>
<span class="va">overlap_df5</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight5"</span><span class="op">)</span>

<span class="va">overlap_df5</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df5</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df5</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df5</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df5</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df5</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df5</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df5</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df5</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df5</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df5</span><span class="op">$</span><span class="va">forward_overlap</span>

<span class="co">################################################################</span>
<span class="va">overlap_df6</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight6"</span><span class="op">)</span>

<span class="va">overlap_df6</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df6</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df6</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df6</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df6</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df6</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df6</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df6</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df6</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df6</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df6</span><span class="op">$</span><span class="va">forward_overlap</span>
<span class="co">###############################################################</span>
<span class="va">overlap_df7</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight7"</span><span class="op">)</span>

<span class="va">overlap_df7</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df7</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df7</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df7</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df7</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df7</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df7</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df7</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df7</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df7</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df7</span><span class="op">$</span><span class="va">forward_overlap</span>
<span class="co">###################################################################</span>
<span class="va">overlap_df8</span><span class="op">=</span><span class="va">overlap_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Flight</span><span class="op">==</span><span class="st">"Flight8"</span><span class="op">)</span>

<span class="va">overlap_df8</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df8</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">overlap_df8</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">1532</span><span class="op">)</span><span class="op">{</span>

  <span class="va">altitude1</span><span class="op">=</span><span class="va">overlap_df8</span><span class="op">$</span><span class="va">altitude1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">altitude2</span><span class="op">=</span><span class="va">overlap_df8</span><span class="op">$</span><span class="va">altitude2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">forward_distance</span><span class="op">=</span><span class="va">overlap_df8</span><span class="op">$</span><span class="va">distance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">angle_of_camera</span><span class="op">=</span><span class="fl">25</span>
  <span class="va">banking_angle1</span><span class="op">=</span><span class="va">overlap_df8</span><span class="op">$</span><span class="va">banking_angle1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">banking_angle2</span><span class="op">=</span><span class="va">overlap_df8</span><span class="op">$</span><span class="va">banking_angle2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>



  <span class="co">#Picture1</span>
  <span class="va">h1</span><span class="op">=</span><span class="va">altitude1</span>
  <span class="co"># angle of camera1</span>
  <span class="va">theta1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle1</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega1</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">-</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm1</span><span class="op">=</span> <span class="va">h1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta1</span><span class="op">+</span><span class="va">phi1</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Picture2</span>
  <span class="va">h2</span><span class="op">=</span><span class="va">altitude2</span>
  <span class="co"># angle of camera2</span>
  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="va">angle_of_camera</span><span class="op">)</span>
  <span class="co"># horizontal field of view</span>
  <span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_HFOV.html">get_HFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="va">banking_angle2</span><span class="op">)</span>
  <span class="co"># vertical field of view</span>
  <span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/deg_to_rad.html">deg_to_rad</a></span><span class="op">(</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/get_VFOV.html">get_VFOV</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">Dc2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">-</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Df2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Dm2</span><span class="op">=</span> <span class="va">h2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">theta2</span><span class="op">+</span><span class="va">phi2</span><span class="op">*</span><span class="fl">0.5</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rc2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rm2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Dm2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Rf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>

  <span class="co">#Work out overlap between trapezoids</span>
  <span class="va">Wc1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc1</span><span class="op">+</span><span class="va">Df1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf1</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span>, <span class="va">Df1</span><span class="op">-</span><span class="va">Dc1</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wc1</span><span class="op">/</span><span class="fl">2</span>, <span class="op">-</span><span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span>, <span class="va">Wf1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">Wc2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Dc2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wm2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">Dc2</span><span class="op">+</span><span class="va">Df2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">Wf2</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">Df2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">h2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">tan</a></span><span class="op">(</span><span class="va">omega2</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">positions2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span>, <span class="va">Df2</span><span class="op">-</span><span class="va">Dc2</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wc2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>,
          <span class="op">-</span><span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span>, <span class="va">Wf2</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">forward_distance</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span><span class="op">)</span>
  <span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygon</a></span><span class="op">(</span><span class="va">positions2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span>
  <span class="va">ps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>
  <span class="va">sps2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#plot(rgeos::gIntersection(sps,sps2), add=TRUE)</span>
  <span class="va">area</span><span class="op">=</span><span class="fu">rgeos</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-bin-gIntersection.html">gIntersection</a></span><span class="op">(</span><span class="va">sps</span>,<span class="va">sps2</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">overlap_df8</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">overlap_df8</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="va">area</span><span class="op">@</span><span class="va">polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">area</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="va">overlap_df8</span><span class="op">$</span><span class="va">forward_overlap</span>

<span class="va">overlap_all</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">overlap_df1</span>,<span class="va">overlap_df2</span>,<span class="va">overlap_df3</span>,<span class="va">overlap_df4</span>,
      <span class="va">overlap_df5</span>,<span class="va">overlap_df6</span>,<span class="va">overlap_df7</span>, <span class="va">overlap_df8</span><span class="op">)</span></code></pre></div>
<p>The mean overlap per Flight is in m2.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">overlap_all</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mnOver<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">forward_overlap</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   Flight  mnOver
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 Flight1 24996.
## 2 Flight2 24345.
## 3 Flight3 21797.
## 4 Flight4 24300.
## 5 Flight5 22826.
## 6 Flight6 23598.
## 7 Flight7 28380.
## 8 Flight8 23426.</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">distance_df</span> <span class="op">%&gt;%</span> 
  <span class="fu">left_join</span><span class="op">(</span><span class="va">overlap_all</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"photo_no"</span><span class="op">=</span><span class="st">"photo_no"</span><span class="op">)</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>,<span class="va">forward_overlap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Flight.x</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 13 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="side-overlap-in-m" class="section level2">
<h2 class="hasAnchor">
<a href="#side-overlap-in-m" class="anchor"></a>Side overlap in m</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">=</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span><span class="st">"side_overlap"</span><span class="op">=</span><span class="fu"><a href="../reference/side_overlap.html">side_overlap</a></span><span class="op">(</span>altitude <span class="op">=</span> <span class="va">alt_above_ground</span>, banking_angle <span class="op">=</span> <span class="va">banking_angle</span><span class="op">)</span><span class="op">)</span>

<span class="va">dfs_reduced</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">time</span>,format<span class="op">=</span><span class="st">"%H:%M:%S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>,<span class="va">side_overlap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Flight</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="Flight_summaries_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="ground-surface-resolution-in-cmpixel" class="section level2">
<h2 class="hasAnchor">
<a href="#ground-surface-resolution-in-cmpixel" class="anchor"></a>Ground surface resolution in cm/pixel</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GSR_all_dfs</span><span class="op">=</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span><span class="fu">mutate</span><span class="op">(</span><span class="st">"GSD_near"</span><span class="op">=</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/GSD.html">GSD</a></span><span class="op">(</span>altitude <span class="op">=</span> <span class="va">alt_above_ground</span>
                                 <span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">%&gt;%</span>  <span class="fu">mutate</span><span class="op">(</span><span class="st">"GSD_mid"</span><span class="op">=</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/GSD.html">GSD</a></span><span class="op">(</span>altitude <span class="op">=</span> <span class="va">alt_above_ground</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"GSD_far"</span><span class="op">=</span><span class="fu">Kulan</span><span class="fu">::</span><span class="fu"><a href="../reference/GSD.html">GSD</a></span><span class="op">(</span>altitude <span class="op">=</span> <span class="va">alt_above_ground</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="va">GSR_all_dfs</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>cm_per_pixel_near<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_near</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, sd_cm_per_pixel_near<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_near</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,cm_per_pixel_far<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_far</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, sd_cm_per_pixel_far<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_far</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 5
##   Flight  cm_per_pixel_near sd_cm_per_pixel_~ cm_per_pixel_far sd_cm_per_pixel_~
##   &lt;chr&gt;               &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;
## 1 Flight1              2.96            0.0597             4.82            0.0973
## 2 Flight2              2.98            0.0775             4.86            0.126 
## 3 Flight3              2.84            0.0536             4.62            0.0873
## 4 Flight4              2.90            0.0446             4.73            0.0725
## 5 Flight5              2.91            0.0870             4.73            0.142 
## 6 Flight6              2.78            0.0801             4.53            0.131 
## 7 Flight7              2.95            0.0303             4.81            0.0494
## 8 Flight8              2.80            0.0859             4.56            0.140</code></pre>
</div>
<div id="distance-covered-by-each-flight-in-km" class="section level2">
<h2 class="hasAnchor">
<a href="#distance-covered-by-each-flight-in-km" class="anchor"></a>Distance covered by each flight in KM</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">dist_sum</span><span class="op">=</span><span class="va">distance_df</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Distance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">coord_dif</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   Flight  Distance
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 Flight1  206258.
## 2 Flight2  189100.
## 3 Flight3  181322.
## 4 Flight4  197963.
## 5 Flight5  189830.
## 6 Flight6  199584.
## 7 Flight7  185306.
## 8 Flight8  165351.</code></pre>
</div>
<div id="generate-summary-ouputs" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-summary-ouputs" class="anchor"></a>Generate summary ouputs</h2>
<div id="flight-summary-table" class="section level3">
<h3 class="hasAnchor">
<a href="#flight-summary-table" class="anchor"></a>Flight summary table</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">&lt;-</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">.</span>,<span class="va">overlap_all</span><span class="op">)</span></code></pre></div>
<pre><code>## Joining, by = c("photo_no", "alt_above_ground", "banking_angle", "Flight")</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfs_reduced</span><span class="op">$</span><span class="va">Rel_for_over</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dfs_reduced</span><span class="op">$</span><span class="va">forward_overlap</span><span class="op">/</span><span class="va">dfs_reduced</span><span class="op">$</span><span class="va">photo_area_R</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>  <span class="co"># add relative forward overlap</span>

<span class="va">dfs_reduced</span><span class="op">&lt;-</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">.</span>, <span class="va">GSR_all_dfs</span><span class="op">)</span></code></pre></div>
<pre><code>## Joining, by = c("photo_no", "date", "time", "lat_dec", "lon_dec", "alt_above_the_sea_level", "alt_above_launch_point", "alt_above_ground", "banking_angle", "tangage", "azimuth", "gps_course", "speed", "gps_speed", "camera_position", "species", "number", "Flight", "v18", "strip_width", "photo_area_R", "photo_area_L", "side_overlap")</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">no_photos</span><span class="op">=</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span>

<span class="va">dfs_reduced</span><span class="op">&lt;-</span><span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">no_photos</span><span class="op">)</span></code></pre></div>
<pre><code>## Joining, by = "Flight"</code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output_summary_table</span> <span class="op">&lt;-</span> <span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, Time_start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, Time_end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>, 
            Mean_Altitude<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">alt_above_ground</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_Altitude=sd(alt_above_ground, na.rm=TRUE), </span>
            Mean_GPS_Speed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gps_speed</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_GPS_Speed=sd(gps_speed, na.rm=TRUE),</span>
            Mean_GPS_dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">coord_dif</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_coord_dif=sd(coord_dif, na.rm=TRUE),</span>
            Mean_Banking<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">banking_angle</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_Banking=sd(banking_angle, na.rm=TRUE), </span>
            Mean_Stripw_right<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">strip_width</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_Stripw_right=sd(strip_width, na.rm=TRUE),</span>
            Mean_GSD_near<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_near</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, Mean_GSD_mid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_mid</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, Mean_GSD_far<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">GSD_far</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
            Mean_Photo_area_R<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">photo_area_R</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_Photo_area=sd(photo_area, na.rm=TRUE)</span>
            Mean_Photo_area_L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">photo_area_L</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="co">#SD_Photo_area=sd(photo_area, na.rm=TRUE)</span>
            Mean_side_overlap<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">side_overlap</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_side_overlap=sd(side_overlap, na.rm=TRUE)) </span>
            Rel_side_overlap<span class="op">=</span><span class="op">(</span><span class="va">Mean_side_overlap</span><span class="op">/</span><span class="va">Mean_Stripw_right</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, <span class="co">#% side overlap</span>
            Mean_for_overlap<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">forward_overlap</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#SD_forward_overlap=sd(forward_overlap, na.rm=TRUE)) </span>
            Rel_for_overlap<span class="op">=</span><span class="op">(</span><span class="va">Mean_for_overlap</span><span class="op">/</span><span class="va">Mean_Photo_area_R</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="co">#% forward overlap</span>

<span class="va">no_photos</span> <span class="op">&lt;-</span> <span class="va">dfs_reduced</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Flight</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">no_photos</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"N_photos_right"</span>

<span class="va">output_summary_table</span> <span class="op">&lt;-</span> <span class="va">output_summary_table</span> <span class="op">%&gt;%</span> 
                        <span class="fu">inner_join</span><span class="op">(</span><span class="va">no_photos</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Flight"</span><span class="op">=</span><span class="st">"Flight"</span><span class="op">)</span><span class="op">)</span>

<span class="va">output_summary_table</span> <span class="op">%&gt;%</span> <span class="fu">view</span><span class="op">(</span><span class="op">)</span>
<span class="co"># You can write the table to .csv using this code below</span>
<span class="co">#write.csv(output_summary_table, "Summary_per_Flight.csv")</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">output_summary_table</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Flight
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Time_start
</th>
<th style="text-align:left;">
Time_end
</th>
<th style="text-align:right;">
Mean_Altitude
</th>
<th style="text-align:right;">
Mean_GPS_Speed
</th>
<th style="text-align:right;">
Mean_GPS_dist
</th>
<th style="text-align:right;">
Mean_Banking
</th>
<th style="text-align:right;">
Mean_Stripw_right
</th>
<th style="text-align:right;">
Mean_GSD_near
</th>
<th style="text-align:right;">
Mean_GSD_mid
</th>
<th style="text-align:right;">
Mean_GSD_far
</th>
<th style="text-align:right;">
Mean_Photo_area_R
</th>
<th style="text-align:right;">
Mean_Photo_area_L
</th>
<th style="text-align:right;">
Mean_side_overlap
</th>
<th style="text-align:right;">
Rel_side_overlap
</th>
<th style="text-align:right;">
Mean_for_overlap
</th>
<th style="text-align:right;">
Rel_for_overlap
</th>
<th style="text-align:right;">
N_photos_right
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Flight1
</td>
<td style="text-align:left;">
16.07.2020
</td>
<td style="text-align:left;">
02:39:02
</td>
<td style="text-align:left;">
05:01:43
</td>
<td style="text-align:right;">
230.0482
</td>
<td style="text-align:right;">
87.30400
</td>
<td style="text-align:right;">
123.9532
</td>
<td style="text-align:right;">
-0.2970571
</td>
<td style="text-align:right;">
307.2174
</td>
<td style="text-align:right;">
2.959628
</td>
<td style="text-align:right;">
3.783562
</td>
<td style="text-align:right;">
4.820468
</td>
<td style="text-align:right;">
63150.85
</td>
<td style="text-align:right;">
64780.96
</td>
<td style="text-align:right;">
10.107387
</td>
<td style="text-align:right;">
3.289979
</td>
<td style="text-align:right;">
24995.57
</td>
<td style="text-align:right;">
39.58073
</td>
<td style="text-align:right;">
1665
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight2
</td>
<td style="text-align:left;">
16.07.2020
</td>
<td style="text-align:left;">
06:19:00
</td>
<td style="text-align:left;">
08:26:52
</td>
<td style="text-align:right;">
231.7539
</td>
<td style="text-align:right;">
87.74318
</td>
<td style="text-align:right;">
126.9129
</td>
<td style="text-align:right;">
-0.2454058
</td>
<td style="text-align:right;">
316.1448
</td>
<td style="text-align:right;">
2.981851
</td>
<td style="text-align:right;">
3.811402
</td>
<td style="text-align:right;">
4.856385
</td>
<td style="text-align:right;">
64820.18
</td>
<td style="text-align:right;">
66520.87
</td>
<td style="text-align:right;">
11.706242
</td>
<td style="text-align:right;">
3.702810
</td>
<td style="text-align:right;">
24345.30
</td>
<td style="text-align:right;">
37.55821
</td>
<td style="text-align:right;">
1491
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight3
</td>
<td style="text-align:left;">
16.07.2020
</td>
<td style="text-align:left;">
13:29:24
</td>
<td style="text-align:left;">
15:34:09
</td>
<td style="text-align:right;">
220.6883
</td>
<td style="text-align:right;">
86.57092
</td>
<td style="text-align:right;">
128.9628
</td>
<td style="text-align:right;">
-0.0968017
</td>
<td style="text-align:right;">
297.6395
</td>
<td style="text-align:right;">
2.839474
</td>
<td style="text-align:right;">
3.629268
</td>
<td style="text-align:right;">
4.624449
</td>
<td style="text-align:right;">
58595.62
</td>
<td style="text-align:right;">
60119.04
</td>
<td style="text-align:right;">
9.831595
</td>
<td style="text-align:right;">
3.303189
</td>
<td style="text-align:right;">
21796.69
</td>
<td style="text-align:right;">
37.19849
</td>
<td style="text-align:right;">
1407
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight4
</td>
<td style="text-align:left;">
17.07.2020
</td>
<td style="text-align:left;">
02:01:37
</td>
<td style="text-align:left;">
04:18:01
</td>
<td style="text-align:right;">
225.7291
</td>
<td style="text-align:right;">
86.85670
</td>
<td style="text-align:right;">
120.9305
</td>
<td style="text-align:right;">
-0.1415751
</td>
<td style="text-align:right;">
300.9421
</td>
<td style="text-align:right;">
2.904310
</td>
<td style="text-align:right;">
3.712430
</td>
<td style="text-align:right;">
4.730134
</td>
<td style="text-align:right;">
60911.70
</td>
<td style="text-align:right;">
62480.83
</td>
<td style="text-align:right;">
9.355282
</td>
<td style="text-align:right;">
3.108666
</td>
<td style="text-align:right;">
24299.73
</td>
<td style="text-align:right;">
39.89337
</td>
<td style="text-align:right;">
1638
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight5
</td>
<td style="text-align:left;">
17.07.2020
</td>
<td style="text-align:left;">
05:21:48
</td>
<td style="text-align:left;">
07:32:28
</td>
<td style="text-align:right;">
225.8599
</td>
<td style="text-align:right;">
86.89314
</td>
<td style="text-align:right;">
126.8068
</td>
<td style="text-align:right;">
0.0208945
</td>
<td style="text-align:right;">
309.2690
</td>
<td style="text-align:right;">
2.905995
</td>
<td style="text-align:right;">
3.714393
</td>
<td style="text-align:right;">
4.732890
</td>
<td style="text-align:right;">
62042.96
</td>
<td style="text-align:right;">
63675.35
</td>
<td style="text-align:right;">
11.049560
</td>
<td style="text-align:right;">
3.572799
</td>
<td style="text-align:right;">
22825.89
</td>
<td style="text-align:right;">
36.79046
</td>
<td style="text-align:right;">
1498
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight6
</td>
<td style="text-align:left;">
17.07.2020
</td>
<td style="text-align:left;">
13:24:26
</td>
<td style="text-align:left;">
15:42:26
</td>
<td style="text-align:right;">
216.2101
</td>
<td style="text-align:right;">
87.96046
</td>
<td style="text-align:right;">
109.7221
</td>
<td style="text-align:right;">
-0.0798901
</td>
<td style="text-align:right;">
290.4986
</td>
<td style="text-align:right;">
2.781764
</td>
<td style="text-align:right;">
3.555775
</td>
<td style="text-align:right;">
4.530473
</td>
<td style="text-align:right;">
56222.16
</td>
<td style="text-align:right;">
57679.71
</td>
<td style="text-align:right;">
9.235642
</td>
<td style="text-align:right;">
3.179238
</td>
<td style="text-align:right;">
23597.91
</td>
<td style="text-align:right;">
41.97261
</td>
<td style="text-align:right;">
1820
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight7
</td>
<td style="text-align:left;">
18.07.2020
</td>
<td style="text-align:left;">
01:17:22
</td>
<td style="text-align:left;">
03:26:59
</td>
<td style="text-align:right;">
229.6322
</td>
<td style="text-align:right;">
83.69114
</td>
<td style="text-align:right;">
128.5060
</td>
<td style="text-align:right;">
0.0120582
</td>
<td style="text-align:right;">
310.6047
</td>
<td style="text-align:right;">
2.954615
</td>
<td style="text-align:right;">
3.776292
</td>
<td style="text-align:right;">
4.811809
</td>
<td style="text-align:right;">
63588.06
</td>
<td style="text-align:right;">
65243.11
</td>
<td style="text-align:right;">
10.075753
</td>
<td style="text-align:right;">
3.243915
</td>
<td style="text-align:right;">
28379.81
</td>
<td style="text-align:right;">
44.63073
</td>
<td style="text-align:right;">
1443
</td>
</tr>
<tr>
<td style="text-align:left;">
Flight8
</td>
<td style="text-align:left;">
18.07.2020
</td>
<td style="text-align:left;">
04:57:29
</td>
<td style="text-align:left;">
06:58:56
</td>
<td style="text-align:right;">
217.5620
</td>
<td style="text-align:right;">
83.15225
</td>
<td style="text-align:right;">
107.9314
</td>
<td style="text-align:right;">
-0.1504240
</td>
<td style="text-align:right;">
296.2667
</td>
<td style="text-align:right;">
2.799185
</td>
<td style="text-align:right;">
3.577991
</td>
<td style="text-align:right;">
4.558917
</td>
<td style="text-align:right;">
57208.30
</td>
<td style="text-align:right;">
58707.40
</td>
<td style="text-align:right;">
10.570364
</td>
<td style="text-align:right;">
3.567854
</td>
<td style="text-align:right;">
23426.34
</td>
<td style="text-align:right;">
40.94920
</td>
<td style="text-align:right;">
1533
</td>
</tr>
</tbody>
</table>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matt Grainger, Petra Kaczensky.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
