---
title: "Flight summaries"
author: "Matt"
subtitle: "`r paste0('updated: ',format(Sys.time(), '%d/%m/%y'))`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(qwraps2_markup = "markdown")
library(tidyverse)
library(readr)
library(qwraps2)
library(Kulan)
library(ggpubr)
```

## Gather all the Flights in to a single dataset

```{r make a large dataset, echo=FALSE, message=FALSE, warning=FALSE}
library(here)
#here::here()
path=paste0(here::here(),"/", "data/tables")
list.files(path)
all_dfs=Kulan::get_tables(path)
```

## Draw the flight paths

```{r}
all_dfs %>% 
  ggplot(aes(Lon_dec,Lat_dec, colour=Class))+
  geom_line()
```

```{r apply grd_in_img function, echo=FALSE, message=FALSE, warning=FALSE}
# For all flights AND each flight  ----------------------------------------

## Get mean & range of ground in image -------------------------------------

data<-all_dfs %>%
  rowwise() %>%
  mutate("grd_in_img"=grd_in_img(`Alt above ground`)) %>%
  janitor::clean_names() # Tidy the column names to make it easier to plot

```

```{r Remove odd data, echo=FALSE, message=FALSE, warning=FALSE}
# Remove empty photographs ------------------------------------------------

#dim(data)[1]
#oddname<-data %>% 
 #  filter(str_detect(photo_no, "IMG"))
#dim(oddname)[1]# 20 empty phots

data<-data %>% 
  filter(!str_detect(photo_no, "IMG")) # remove the odd photos from the data

#dim(data)

#names(data)
```

## Strip-width summary

```{r, results='asis', echo=FALSE,, message=FALSE, warning=FALSE}
 # data %>% 
 #   group_by(class) %>%
 #  select(grd_in_img) %>% 
 #   summarise(mn=mean(grd_in_img), sd=sd(grd_in_img), min=min(grd_in_img), max=max(grd_in_img))


our_summary1 <-
  list("strip width" =
         list("min"       = ~ round(min(grd_in_img)),
              "max"       = ~ round(max(grd_in_img)),
              "mean (sd)" = ~ qwraps2::mean_sd(grd_in_img)))


tab_1<-qwraps2::summary_table(dplyr::group_by(data, class),our_summary1)
tab_1

```




```{r}

```

